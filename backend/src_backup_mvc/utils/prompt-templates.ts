/**
 * プロンプトテンプレート
 * 呼び水質問や対話生成のためのテンプレートを提供する
 */
export const promptTemplates = {
  /**
   * 呼び水質問テンプレートを取得
   * @param category 質問カテゴリ
   * @returns テンプレート文字列
   */
  getPromptQuestionTemplate: (category: string): string => {
    const templates: Record<string, string> = {
      // 成長視点のテンプレート
      'growth': `
以下の情報を基に、美容師の技術的成長に関する呼び水質問を生成してください。
質問は陰陽五行の{dailyElement}の特性を活かし、ユーザーの主属性である{userElement}との相性も考慮してください。
本日の運勢スコアは{overallLuck}であり、{dailyYinYang}の気が強い日です。

質問例：
「今日は技術向上の運気が高まる日です。このサロンで習得したい次の技術は何ですか？」
「創造力が冴える日です。お客様に提案したい新しいスタイルのアイデアはありますか？」

一つの魅力的な質問を生成してください。質問は単一の段落で、100文字以内に収めてください。
`,

      // チーム視点のテンプレート
      'team': `
以下の情報を基に、美容師のチーム連携や人間関係に関する呼び水質問を生成してください。
質問は陰陽五行の{dailyElement}の特性を活かし、ユーザーの主属性である{userElement}との相性も考慮してください。
本日の運勢スコアは{overallLuck}であり、{dailyYinYang}の気が強い日です。

質問例：
「人間関係の運気が高まっています。チームで一緒に取り組みたいプロジェクトはありますか？」
「調和の日です。サロン内で最も一緒に働くのが楽しい同僚は誰ですか？その理由は？」

一つの魅力的な質問を生成してください。質問は単一の段落で、100文字以内に収めてください。
`,

      // キャリア視点のテンプレート
      'career': `
以下の情報を基に、美容師のキャリア開発に関する呼び水質問を生成してください。
質問は陰陽五行の{dailyElement}の特性を活かし、ユーザーの主属性である{userElement}との相性も考慮してください。
本日の運勢スコアは{overallLuck}であり、{dailyYinYang}の気が強い日です。

質問例：
「キャリア運が開ける日です。このサロンで5年後どんなポジションにいたいですか？」
「成長の気運が高まっています。サロン内でのキャリアにおいて次に達成したい目標は？」

一つの魅力的な質問を生成してください。質問は単一の段落で、100文字以内に収めてください。
`,

      // 組織貢献視点のテンプレート
      'organization': `
以下の情報を基に、美容師の組織貢献に関する呼び水質問を生成してください。
質問は陰陽五行の{dailyElement}の特性を活かし、ユーザーの主属性である{userElement}との相性も考慮してください。
本日の運勢スコアは{overallLuck}であり、{dailyYinYang}の気が強い日です。

質問例：
「発信力が高まる日です。サロンの評判向上のためにできることはありますか？」
「アイデアが湧く日です。サロン全体のサービス向上につながる提案はありますか？」

一つの魅力的な質問を生成してください。質問は単一の段落で、100文字以内に収めてください。
`,

      // デフォルトテンプレート
      'default': `
以下の情報を基に、美容師向けの魅力的な呼び水質問を生成してください。
質問は陰陽五行の{dailyElement}の特性を活かし、ユーザーの主属性である{userElement}との相性も考慮してください。
本日の運勢スコアは{overallLuck}であり、{dailyYinYang}の気が強い日です。

一つの魅力的な質問を生成してください。質問は単一の段落で、100文字以内に収めてください。
`
    };

    return templates[category] || templates.default;
  },

  /**
   * 会話文脈に基づく追加プロンプトを生成
   * @param context 会話の文脈情報
   * @returns 追加プロンプト
   */
  getContextualPrompt: (context: any): string => {
    if (!context) return '';

    let contextualPrompt = '';

    // 運勢情報が含まれている場合
    if (context.fortuneId) {
      contextualPrompt += `
この会話はユーザーの今日の運勢に関連しています。運勢に基づいたアドバイスを提供し、
陰陽五行の要素を取り入れた応答を心がけてください。
`;
    }

    // 目標情報が含まれている場合
    if (context.relatedGoalId) {
      contextualPrompt += `
この会話はユーザーの目標に関連しています。目標達成のための具体的なステップと
陰陽五行の知恵を組み合わせたアドバイスを提供してください。
`;
    }

    // チーム関連の会話の場合
    if (context.teamRelated) {
      contextualPrompt += `
この会話はチームワークや職場の人間関係に関連しています。
陰陽五行の調和とバランスの原則に基づいたアドバイスを提供してください。
`;
    }

    return contextualPrompt;
  },

  /**
   * 感情分析結果に基づくフォローアッププロンプトを生成
   * @param sentimentScore 感情分析スコア（-1.0〜1.0）
   * @returns フォローアッププロンプト
   */
  getSentimentBasedPrompt: (sentimentScore: number): string => {
    if (sentimentScore <= -0.5) {
      // 強いネガティブ感情
      return `
ユーザーは非常にネガティブな感情を表現しています。共感的で支持的な応答を心がけ、
前向きな視点を優しく提案してください。解決策よりも傾聴と理解を優先してください。
`;
    } else if (sentimentScore < 0) {
      // 軽度のネガティブ感情
      return `
ユーザーは若干のネガティブな感情を表現しています。共感と理解を示しながら、
建設的な提案や陰陽五行の知恵に基づいたバランス回復のアドバイスを提供してください。
`;
    } else if (sentimentScore > 0.5) {
      // 強いポジティブ感情
      return `
ユーザーは非常にポジティブな感情を表現しています。この前向きなエネルギーを活かし、
さらなる成長や新たな目標に挑戦するよう促してください。
`;
    } else if (sentimentScore > 0) {
      // 軽度のポジティブ感情
      return `
ユーザーはポジティブな感情を表現しています。この良い状態を維持するための
陰陽五行のバランスのヒントを提供し、さらなる成長を促してください。
`;
    } else {
      // 中立的な感情
      return `
ユーザーは中立的な感情を表現しています。興味を引き出す質問や洞察を提供し、
対話を深めるよう心がけてください。
`;
    }
  }
};