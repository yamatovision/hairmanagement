/**
 * 十神関係の計算をシンプルにテスト
 */

// 地支の十神計算関数
function determineBranchTenGodRelation(dayStem, branch) {
  // 天干と五行の対応
  const stemToElement = {
    '甲': '木', '乙': '木',
    '丙': '火', '丁': '火',
    '戊': '土', '己': '土',
    '庚': '金', '辛': '金',
    '壬': '水', '癸': '水'
  };
  
  // 地支と五行の対応
  const branchToElement = {
    '寅': '木', '卯': '木',
    '巳': '火', '午': '火',
    '辰': '土', '丑': '土', '未': '土', '戌': '土',
    '申': '金', '酉': '金',
    '子': '水', '亥': '水'
  };
  
  // 十神対応表（日干の五行と対象の五行の関係）
  const tenGodMap = {
    '木': {
      '木': { '陽': '比肩', '陰': '劫財' },   // 木生木
      '火': { '陽': '食神', '陰': '傷官' },   // 木生火
      '土': { '陽': '財星', '陰': '才星' },   // 木被土克
      '金': { '陽': '官星', '陰': '殺' },     // 木克金
      '水': { '陽': '印綬', '陰': '枭神' }    // 水生木
    },
    '火': {
      '木': { '陽': '印綬', '陰': '枭神' },   // 木生火
      '火': { '陽': '比肩', '陰': '劫財' },   // 火生火
      '土': { '陽': '食神', '陰': '傷官' },   // 火生土
      '金': { '陽': '財星', '陰': '才星' },   // 火被金克
      '水': { '陽': '官星', '陰': '殺' }      // 火克水
    },
    '土': {
      '木': { '陽': '官星', '陰': '殺' },     // 土克木
      '火': { '陽': '印綬', '陰': '枭神' },   // 火生土
      '土': { '陽': '比肩', '陰': '劫財' },   // 土生土
      '金': { '陽': '食神', '陰': '傷官' },   // 土生金
      '水': { '陽': '財星', '陰': '才星' }    // 土被水克
    },
    '金': {
      '木': { '陽': '財星', '陰': '才星' },   // 金被木克
      '火': { '陽': '官星', '陰': '殺' },     // 金克火
      '土': { '陽': '印綬', '陰': '枭神' },   // 土生金
      '金': { '陽': '比肩', '陰': '劫財' },   // 金生金
      '水': { '陽': '食神', '陰': '傷官' }    // 金生水
    },
    '水': {
      '木': { '陽': '食神', '陰': '傷官' },   // 水生木
      '火': { '陽': '財星', '陰': '才星' },   // 水被火克
      '土': { '陽': '官星', '陰': '殺' },     // 水克土
      '金': { '陽': '印綬', '陰': '枭神' },   // 金生水
      '水': { '陽': '比肩', '陰': '傷官' }    // 水生水
    }
  };
  
  // 簡易変換表
  const simpleTenGodMap = {
    '比肩': '比肩',
    '劫財': '劫財',
    '食神': '食神',
    '傷官': '傷官',
    '財星': '偏財',
    '才星': '正財',
    '官星': '正官',
    '殺': '七殺',
    '印綬': '正印',
    '枭神': '偏印'
  };
  
  // 陰陽の対応
  const isYang = (stem) => ['甲', '丙', '戊', '庚', '壬'].includes(stem);
  
  // 日干と地支の五行を取得
  const dayStemElement = stemToElement[dayStem];
  const branchElement = branchToElement[branch];
  
  if (!dayStemElement || !branchElement) {
    console.error('無効な天干または地支:', { dayStem, branch });
    return null;
  }
  
  console.log(`地支十神計算: ${dayStem} × ${branch}`);
  
  // 五行関係から十神を判定
  const yinYang = isYang(dayStem) ? '陽' : '陰';
  const relationKey = tenGodMap[dayStemElement][branchElement][yinYang];
  
  // 標準化された十神名を返す
  return simpleTenGodMap[relationKey] || null;
}

// テスト実行
function runTests() {
  // 日干のリスト
  const stems = ['甲', '乙', '丙', '丁', '戊', '己', '庚', '辛', '壬', '癸'];
  
  // 地支のリスト
  const branches = ['子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥'];
  
  console.log('====== 地支十神計算テスト ======');
  
  // すべての組み合わせをテスト
  stems.forEach(stem => {
    console.log(`\n日干: ${stem} の地支十神関係:`);
    branches.forEach(branch => {
      const tenGod = determineBranchTenGodRelation(stem, branch);
      console.log(`  ${branch}: ${tenGod || '不明'}`);
    });
  });
}

// テスト実行
runTests();

console.log('\nテスト完了');