
> hairmanagement-backend@1.0.0 dev
> nodemon --exec "TS_NODE_TRANSPILE_ONLY=true ts-node -r tsconfig-paths/register src/index.ts"

[33m[nodemon] 2.0.22[39m
[33m[nodemon] to restart at any time, enter `rs`[39m
[33m[nodemon] watching path(s): src/**/* shared[39m
[33m[nodemon] watching extensions: ts[39m
[32m[nodemon] starting `TS_NODE_TRANSPILE_ONLY=true ts-node -r tsconfig-paths/register src/index.ts`[39m
事前登録: AuthMiddlewareが登録されました
データベース接続を開始します...
既存のUserモデルを使用します
ISubscriptionRepositoryが正常に登録されました
Teamモデルを登録しました
TeamModelが正常に登録されました
ITeamRepositoryが正常に登録されました
Conversationモデルを登録しました
ConversationModelが正常に登録されました
IConversationRepositoryが正常に登録されました
Subscriptionモデルを登録しました
SubscriptionModelが正常に登録されました
サブスクリプションサービスが正常に登録されました
BirthLocationServiceが正常に登録されました
SajuCalculatorServiceが正常に登録されました
TeamCompatibilityServiceが正常に登録されました
ConversationServiceが正常に登録されました
ClaudeAI設定を確認:
- API URL: https://api.anthropic.com/v1/messages
- APIキー: sk-ant-api...xXAAA (108文字)
- モデル: claude-3-7-sonnet-20250219
ClaudeAIServiceが正常に登録されました
注意: 実際のAPIキーが設定されています。
AuthControllerが正常に登録されました
AuthMiddlewareが正常に登録されました
SubscriptionControllerが正常に登録されました
UserControllerが正常に登録されました
ConversationControllerとAuthMiddlewareが正常に登録されました
アプリケーションの初期化を開始します...
使用ポート: 3001
ミドルウェアを設定します...
CORS設定: http://localhost:3000
サーバーネットワーク設定:
{
  "lo0": [
    {
      "address": "127.0.0.1",
      "netmask": "255.0.0.0",
      "family": "IPv4",
      "mac": "00:00:00:00:00:00",
      "internal": true,
      "cidr": "127.0.0.1/8"
    },
    {
      "address": "::1",
      "netmask": "ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff",
      "family": "IPv6",
      "mac": "00:00:00:00:00:00",
      "internal": true,
      "cidr": "::1/128",
      "scopeid": 0
    },
    {
      "address": "fe80::1",
      "netmask": "ffff:ffff:ffff:ffff::",
      "family": "IPv6",
      "mac": "00:00:00:00:00:00",
      "internal": true,
      "cidr": "fe80::1/64",
      "scopeid": 1
    }
  ],
  "en0": [
    {
      "address": "fe80::826:ac61:9092:cf1d",
      "netmask": "ffff:ffff:ffff:ffff::",
      "family": "IPv6",
      "mac": "0e:07:27:7b:85:f1",
      "internal": false,
      "cidr": "fe80::826:ac61:9092:cf1d/64",
      "scopeid": 11
    },
    {
      "address": "192.168.11.15",
      "netmask": "255.255.255.0",
      "family": "IPv4",
      "mac": "0e:07:27:7b:85:f1",
      "internal": false,
      "cidr": "192.168.11.15/24"
    }
  ],
  "awdl0": [
    {
      "address": "fe80::1c0c:4ff:fe99:fab0",
      "netmask": "ffff:ffff:ffff:ffff::",
      "family": "IPv6",
      "mac": "1e:0c:04:99:fa:b0",
      "internal": false,
      "cidr": "fe80::1c0c:4ff:fe99:fab0/64",
      "scopeid": 13
    }
  ],
  "llw0": [
    {
      "address": "fe80::1c0c:4ff:fe99:fab0",
      "netmask": "ffff:ffff:ffff:ffff::",
      "family": "IPv6",
      "mac": "1e:0c:04:99:fa:b0",
      "internal": false,
      "cidr": "fe80::1c0c:4ff:fe99:fab0/64",
      "scopeid": 14
    }
  ],
  "utun4": [
    {
      "address": "fe80::3fa7:63db:1271:f967",
      "netmask": "ffff:ffff:ffff:ffff::",
      "family": "IPv6",
      "mac": "00:00:00:00:00:00",
      "internal": false,
      "cidr": "fe80::3fa7:63db:1271:f967/64",
      "scopeid": 19
    }
  ],
  "utun5": [
    {
      "address": "fe80::6c3f:f7c2:e653:b6b6",
      "netmask": "ffff:ffff:ffff:ffff::",
      "family": "IPv6",
      "mac": "00:00:00:00:00:00",
      "internal": false,
      "cidr": "fe80::6c3f:f7c2:e653:b6b6/64",
      "scopeid": 20
    }
  ],
  "utun6": [
    {
      "address": "fe80::ab60:d1dd:6383:391",
      "netmask": "ffff:ffff:ffff:ffff::",
      "family": "IPv6",
      "mac": "00:00:00:00:00:00",
      "internal": false,
      "cidr": "fe80::ab60:d1dd:6383:391/64",
      "scopeid": 21
    }
  ],
  "utun7": [
    {
      "address": "fe80::ce81:b1c:bd2c:69e",
      "netmask": "ffff:ffff:ffff:ffff::",
      "family": "IPv6",
      "mac": "00:00:00:00:00:00",
      "internal": false,
      "cidr": "fe80::ce81:b1c:bd2c:69e/64",
      "scopeid": 22
    }
  ],
  "utun0": [
    {
      "address": "fe80::dc8d:3cf4:3159:c8d8",
      "netmask": "ffff:ffff:ffff:ffff::",
      "family": "IPv6",
      "mac": "00:00:00:00:00:00",
      "internal": false,
      "cidr": "fe80::dc8d:3cf4:3159:c8d8/64",
      "scopeid": 26
    }
  ],
  "utun1": [
    {
      "address": "fe80::3fd:6689:97a0:85a7",
      "netmask": "ffff:ffff:ffff:ffff::",
      "family": "IPv6",
      "mac": "00:00:00:00:00:00",
      "internal": false,
      "cidr": "fe80::3fd:6689:97a0:85a7/64",
      "scopeid": 27
    }
  ]
}
有効化された機能: 認証, 運勢, チーム, 分析, 会話
認証機能: 有効
運勢機能: 有効
チーム機能: 有効
分析機能: 有効
会話機能: 有効
クリーンアーキテクチャのルート登録を試行...
AuthController起動: JWT環境変数チェック
- JWT_SECRET: 設定済み
- JWT_REFRESH_SECRET: 未設定
- JWT_ACCESS_EXPIRATION: 1d
- NODE_ENV: development
2025-04-03 11:57:25:5725 [32minfo[39m: [32mConversationService initialized[39m  
2025-04-03 11:57:25:5725 [32minfo[39m: [32mConversationService initialized[39m  
2025-04-03 11:57:25:5725 [32minfo[39m: [32mConversationService initialized[39m  
2025-04-03 11:57:25:5725 [32minfo[39m: [32mConversationService initialized[39m  
2025-04-03 11:57:25:5725 [32minfo[39m: [32mConversationService initialized[39m  
2025-04-03 11:57:25:5725 [32minfo[39m: [32mConversationService initialized[39m  
2025-04-03 11:57:25:5725 [32minfo[39m: [32mConversationService initialized[39m  
2025-04-03 11:57:25:5725 [32minfo[39m: [32mConversationService initialized[39m  
登録されたルート:
POST /api/v1/auth/login
POST /api/v1/auth/register
POST /api/v1/auth/refresh-token
POST /api/v1/auth/logout
POST /api/v1/api/v1/auth/login
POST /api/v1/api/v1/auth/register
POST /api/v1/api/v1/auth/refresh-token
POST /api/v1/api/v1/auth/logout
GET /api/v1/auth/verify-token
GET /api/v1/users/me
GET /api/v1/users/me/saju-profile
PUT /api/v1/users/me
PUT /api/v1/users/me/password
GET /api/v1/users
GET /api/v1/users/:userId
GET /api/v1/fortune/debug
GET /api/v1/fortune/daily
GET /api/v1/fortune/date/:date
GET /api/v1/fortune/range
GET /api/v1/fortune/team-compatibility
GET /api/v1/fortune/saju
GET /api/v1/subscriptions
GET /api/v1/subscriptions/:id
GET /api/v1/subscriptions/team/:teamId
GET /api/v1/subscriptions/user/:userId
GET /api/v1/subscriptions/user/:userId/ai-model
POST /api/v1/subscriptions
POST /api/v1/subscriptions/user
PATCH /api/v1/subscriptions/:id/plan
PATCH /api/v1/subscriptions/:id/status
DELETE /api/v1/subscriptions/:id
GET /api/v1/teams
GET /api/v1/teams/:teamId
POST /api/v1/teams
PUT /api/v1/teams/:teamId
DELETE /api/v1/teams/:teamId
POST /api/v1/teams/:teamId/members
DELETE /api/v1/teams/:teamId/members/:memberId
PUT /api/v1/teams/:teamId/members/:memberId/role
GET /api/v1/teams/:teamId/compatibility
POST /api/v1/teams/:teamId/invite
GET /api/v1/health
GET /api/v1/api-docs
クリーンアーキテクチャのルート登録成功！ベースパス: /api/v1
============== サーバー起動プロセス開始 ==============
環境変数:
- NODE_ENV: development
- PORT: 3001
- MONGODB_URI: 設定済み
- DB_URI: 設定済み
- SKIP_DB_ERRORS: undefined
- EVENT_STORE_TYPE: デフォルト
機能フラグ:
- enableAuth: true
- enableFortune: true
- enableTeam: true
- enableAnalytics: true
- enableConversation: true
2025-04-03 11:57:25:5725 [32minfo[39m: [32mMongoDB URI: mongodb://localhost:...[39m  
モデル読み込み状態:
- Userモデルは既に登録されています
データベース接続を開始します...
2025-04-03 11:57:25:5725 [32minfo[39m: [32mMongoDB URI: mongodb://localhost:...[39m  
2025-04-03 11:57:25:5725 [32minfo[39m: [32mMongoDB接続成功！[39m  
2025-04-03 11:57:25:5725 [32minfo[39m: [32mMongoDB接続成功！[39m  
データベース接続が確立されました
登録済みMongooseモデル: User, Team, Conversation, Fortune, Subscription
イベントハンドラーの初期化を開始します...
UserEvents モジュールが正常に読み込まれました
TeamEvents モジュールが正常に読み込まれました
ConversationEvents モジュールが正常に読み込まれました
UserEventHandlers モジュールが正常に読み込まれました
TeamEventHandlers モジュールが正常に読み込まれました
ConversationEventHandlers モジュールが正常に読み込まれました
イベントハンドラーの初期化を開始します...
イベントバスが正常に解決されました
イベントハンドラーの登録を試行します...
UserEventHandlersを初期化中...
2025-04-03 11:57:25:5725 [34mdebug[39m: [34mイベントハンドラー登録: user.created[39m  
2025-04-03 11:57:25:5725 [34mdebug[39m: [34mイベントハンドラー登録: user.updated[39m  
2025-04-03 11:57:25:5725 [34mdebug[39m: [34mイベントハンドラー登録: user.profile.updated[39m  
2025-04-03 11:57:25:5725 [34mdebug[39m: [34mイベントハンドラー登録: user.role.changed[39m  
2025-04-03 11:57:25:5725 [34mdebug[39m: [34mイベントハンドラー登録: user.logged_in[39m  
2025-04-03 11:57:25:5725 [32minfo[39m: [32mユーザーイベントハンドラーが登録されました[39m  
UserEventHandlersが正常に初期化されました
TeamEventHandlersを初期化中...
2025-04-03 11:57:25:5725 [34mdebug[39m: [34mイベントハンドラー登録: team.created[39m  
2025-04-03 11:57:25:5725 [34mdebug[39m: [34mイベントハンドラー登録: team.updated[39m  
2025-04-03 11:57:25:5725 [34mdebug[39m: [34mイベントハンドラー登録: team.member.added[39m  
2025-04-03 11:57:25:5725 [34mdebug[39m: [34mイベントハンドラー登録: team.member.removed[39m  
2025-04-03 11:57:25:5725 [34mdebug[39m: [34mイベントハンドラー登録: team.member.role_changed[39m  
2025-04-03 11:57:25:5725 [34mdebug[39m: [34mイベントハンドラー登録: team.invitation.sent[39m  
2025-04-03 11:57:25:5725 [34mdebug[39m: [34mイベントハンドラー登録: team.invitation.accepted[39m  
2025-04-03 11:57:25:5725 [34mdebug[39m: [34mイベントハンドラー登録: team.invitation.declined[39m  
2025-04-03 11:57:25:5725 [34mdebug[39m: [34mイベントハンドラー登録: team.compatibility.changed[39m  
2025-04-03 11:57:25:5725 [32minfo[39m: [32mチームイベントハンドラーが登録されました[39m  
TeamEventHandlersが正常に初期化されました
ConversationEventHandlersを初期化中...
2025-04-03 11:57:25:5725 [34mdebug[39m: [34mイベントハンドラー登録: conversation.created[39m  
2025-04-03 11:57:25:5725 [34mdebug[39m: [34mイベントハンドラー登録: conversation.message.added[39m  
2025-04-03 11:57:25:5725 [34mdebug[39m: [34mイベントハンドラー登録: conversation.sentiment.analyzed[39m  
2025-04-03 11:57:25:5725 [34mdebug[39m: [34mイベントハンドラー登録: conversation.elemental.tagged[39m  
2025-04-03 11:57:25:5725 [34mdebug[39m: [34mイベントハンドラー登録: conversation.ended[39m  
2025-04-03 11:57:25:5725 [32minfo[39m: [32m会話イベントハンドラーが登録されました[39m  
ConversationEventHandlersが正常に初期化されました
イベントハンドラーの初期化が完了しました
イベント駆動アーキテクチャを初期化しました
サーバーが起動しました: http://0.0.0.0:3001
APIエンドポイント: http://0.0.0.0:3001/api/v1
環境変数PORT: 3001
NODE_ENV: development
有効なルート:
post /^\/api\/v1\/?(?=\/|$)/i /auth/login
post /^\/api\/v1\/?(?=\/|$)/i /auth/register
post /^\/api\/v1\/?(?=\/|$)/i /auth/refresh-token
post /^\/api\/v1\/?(?=\/|$)/i /auth/logout
post /^\/api\/v1\/?(?=\/|$)/i /api/v1/auth/login
post /^\/api\/v1\/?(?=\/|$)/i /api/v1/auth/register
post /^\/api\/v1\/?(?=\/|$)/i /api/v1/auth/refresh-token
post /^\/api\/v1\/?(?=\/|$)/i /api/v1/auth/logout
get /^\/api\/v1\/?(?=\/|$)/i /auth/verify-token
get /^\/api\/v1\/?(?=\/|$)/i /users/me
get /^\/api\/v1\/?(?=\/|$)/i /users/me/saju-profile
put /^\/api\/v1\/?(?=\/|$)/i /users/me
put /^\/api\/v1\/?(?=\/|$)/i /users/me/password
get /^\/api\/v1\/?(?=\/|$)/i /users
get /^\/api\/v1\/?(?=\/|$)/i /users/:userId
get /^\/api\/v1\/?(?=\/|$)/i /fortune/debug
get /^\/api\/v1\/?(?=\/|$)/i /fortune/daily
get /^\/api\/v1\/?(?=\/|$)/i /fortune/date/:date
get /^\/api\/v1\/?(?=\/|$)/i /fortune/range
get /^\/api\/v1\/?(?=\/|$)/i /fortune/team-compatibility
get /^\/api\/v1\/?(?=\/|$)/i /fortune/saju
get /^\/api\/v1\/?(?=\/|$)/i /subscriptions
get /^\/api\/v1\/?(?=\/|$)/i /subscriptions/:id
get /^\/api\/v1\/?(?=\/|$)/i /subscriptions/team/:teamId
get /^\/api\/v1\/?(?=\/|$)/i /subscriptions/user/:userId
get /^\/api\/v1\/?(?=\/|$)/i /subscriptions/user/:userId/ai-model
post /^\/api\/v1\/?(?=\/|$)/i /subscriptions
post /^\/api\/v1\/?(?=\/|$)/i /subscriptions/user
patch /^\/api\/v1\/?(?=\/|$)/i /subscriptions/:id/plan
patch /^\/api\/v1\/?(?=\/|$)/i /subscriptions/:id/status
delete /^\/api\/v1\/?(?=\/|$)/i /subscriptions/:id
get /^\/api\/v1\/?(?=\/|$)/i /teams
get /^\/api\/v1\/?(?=\/|$)/i /teams/:teamId
post /^\/api\/v1\/?(?=\/|$)/i /teams
put /^\/api\/v1\/?(?=\/|$)/i /teams/:teamId
delete /^\/api\/v1\/?(?=\/|$)/i /teams/:teamId
post /^\/api\/v1\/?(?=\/|$)/i /teams/:teamId/members
delete /^\/api\/v1\/?(?=\/|$)/i /teams/:teamId/members/:memberId
put /^\/api\/v1\/?(?=\/|$)/i /teams/:teamId/members/:memberId/role
get /^\/api\/v1\/?(?=\/|$)/i /teams/:teamId/compatibility
post /^\/api\/v1\/?(?=\/|$)/i /teams/:teamId/invite
get /^\/api\/v1\/?(?=\/|$)/i /health
get /^\/api\/v1\/?(?=\/|$)/i /api-docs
get /_ah/health
get /healthz
get /
2025-04-03 11:57:25:5725 [32minfo[39m: [32mMongoDB接続成功[39m  
データベース接続成功（setupDatabase）
[2025-04-03T02:57:59.124Z] リクエスト: POST /api/v1/auth/login - クライアントIP: 127.0.0.1
ヘッダー: {"accept":"application/json, text/plain, */*","content-type":"application/json","user-agent":"axios/1.8.4","content-length":"51","accept-encoding":"gzip, compress, deflate, br","host":"127.0.0.1:3001","connection":"close"}
ボディ: {"email":"admin@example.com","password":"*****"}
2025-04-03 11:57:59:5759 [32mhttp[39m: [32mPOST /api/v1/auth/login[39m  
{
  "ip": "127.0.0.1",
  "userAgent": "axios/1.8.4"
}
[2025-04-03T02:57:59.206Z] レスポンス: 200 POST /api/v1/auth/login
レスポンスボディ: {
  "user": {
    "id": "67e487dbc4a58a62d38ac6ac",
    "email": "admin@example.com",
    "name": "白石達也",
    "role": "admin"
  },
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiI2N2U0ODdkYmM0YTU4YTYyZDM4YWM2YWMiLCJyb2xlIjoiYWRtaW4iLCJpYXQiOjE3NDM2NDkwNzksImV4cCI6MTc0MzY1MjY3OX0.NZQ6-nAAPL-1bLPf8gEdkxWaf0zdsuCmxccsXXJ2ALc",
  "refreshToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiI2N2U0ODdkYmM0YTU4YTYyZDM4YWM2YWMiLCJpYXQiOjE3NDM2NDkwNzksImV4cCI6MTc0NDI1Mzg3OX0.fztu-WLGJbfQRVEmzg0Rvct7h5zRUkL4biueFaSFpM0"
}
[0mPOST /api/v1/auth/login [32m200[0m 83.162 ms - 508[0m
[2025-04-03T02:57:59.212Z] リクエスト: GET /api/v1/fortune/daily - クライアントIP: 127.0.0.1
ヘッダー: {"accept":"application/json, text/plain, */*","authorization":"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiI2N2U0ODdkYmM0YTU4YTYyZDM4YWM2YWMiLCJyb2xlIjoiYWRtaW4iLCJpYXQiOjE3NDM2NDkwNzksImV4cCI6MTc0MzY1MjY3OX0.NZQ6-nAAPL-1bLPf8gEdkxWaf0zdsuCmxccsXXJ2ALc","user-agent":"axios/1.8.4","accept-encoding":"gzip, compress, deflate, br","host":"127.0.0.1:3001","connection":"close"}
2025-04-03 11:57:59:5759 [32mhttp[39m: [32mGET /api/v1/fortune/daily[39m  
{
  "ip": "127.0.0.1",
  "userAgent": "axios/1.8.4"
}
[AuthMiddleware] リクエストパス: /fortune/daily
[AuthMiddleware] リクエストメソッド: GET
[AuthMiddleware] リクエストヘッダー: {
  accept: 'application/json, text/plain, */*',
  authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiI2N2U0ODdkYmM0YTU4YTYyZDM4YWM2YWMiLCJyb2xlIjoiYWRtaW4iLCJpYXQiOjE3NDM2NDkwNzksImV4cCI6MTc0MzY1MjY3OX0.NZQ6-nAAPL-1bLPf8gEdkxWaf0zdsuCmxccsXXJ2ALc',
  'user-agent': 'axios/1.8.4',
  'accept-encoding': 'gzip, compress, deflate, br',
  host: '127.0.0.1:3001',
  connection: 'close'
}
[AuthMiddleware] 抽出されたトークン: eyJhbGciOi...
[AuthMiddleware] トークン検証開始
[TokenService] トークン検証開始: eyJhbGciOi...
[TokenService] シークレットキー: pat***
[TokenService] 環境変数NODE_ENV: development
[TokenService] トークンデコード結果(検証なし): {
  "userId": "67e487dbc4a58a62d38ac6ac",
  "role": "admin",
  "iat": 1743649079,
  "exp": 1743652679
}
[TokenService] トークン検証成功: {"userId":"67e487dbc4a58a62d38ac6ac","role":"admin","iat":1743649079,"exp":1743652679}
[AuthMiddleware] ユーザー認証成功: 67e487dbc4a58a62d38ac6ac
[AuthMiddleware] req.user設定完了: {
  id: '67e487dbc4a58a62d38ac6ac',
  role: 'admin',
  userId: '67e487dbc4a58a62d38ac6ac',
  iat: 1743649079,
  exp: 1743652679
}
[FortuneController] getDailyFortune リクエスト: {
  userId: '67e487dbc4a58a62d38ac6ac',
  query: {},
  headers: undefined,
  auth: '設定済み'
}
[FortuneController] birthDateが未指定のため、デフォルト値を使用します
[FortuneController] 運勢計算用パラメータ: { userId: '67e487dbc4a58a62d38ac6ac', birthDate: '1990-01-01' }
[運勢フローログ] ElementalCalculatorService.getDailyFortune 開始 - ユーザー: 67e487dbc4a58a62d38ac6ac, 生年月日: 1990-01-01
[運勢フローログ] MongoFortuneRepository.findByUserIdAndDate を呼び出し - 日付: 2025-04-03T02:57:59.214Z
[MongoFortuneRepository] findByUserIdAndDate: userId=67e487dbc4a58a62d38ac6ac, date=2025-04-03
[MongoFortuneRepository] 運勢が見つかりました: _id=67ede73a4754935e08a6c3b3, userId=67e487dbc4a58a62d38ac6ac, date=2025-04-03
[MongoFortuneRepository] toDomainEntity: docId=67ede73a4754935e08a6c3b3, hasAiGeneratedAdvice=true
[MongoFortuneRepository] aiGeneratedAdviceを構造化データとして処理します
[運勢フローログ] findByUserIdAndDate の結果: 運勢が見つかりました
[運勢フローログ] ElementalCalculatorService.getDailyFortune 完了 - 運勢ID: 67ede73a4754935e08a6c3b3
[FortuneController.formatFortuneResponse] AIGeneratedAdvice確認: {
  adviceType: 'string',
  hasAIGeneratedAdvice: true,
  isObject: false,
  hasAdvice: true,
  summary: null,
  luckyPoints: 'あり',
  aiGeneratedAdviceType: 'object'
}
地方時調整: 東京（経度139.77）=> 18分
特殊ケース処理を適用します: 1990-01-01T03:18:00.000Z 12 undefined
十神関係計算前の四柱情報:
日柱天干: 丙 日柱地支: 寅
年柱天干: 己 年柱地支: 巳
月柱天干: 丙 月柱地支: 子
時柱天干: 辛 時柱地支: 午
十神関係計算結果: {
  "year": "傷官",
  "month": "比肩",
  "day": "比肩",
  "hour": "正財"
}
年柱地支: 巳
月柱地支: 子
日柱地支: 寅
時柱地支: 午
日主天干: 丙
地支十神関係の計算結果:
年支(巳)の十神: 劫財
月支(子)の十神: 偏官
日支(寅)の十神: 偏印
時支(午)の十神: 比肩
年支の蔵干: 丙(比肩), 庚(偏財), 戊(食神)
最終的な地支の十神関係:
年柱地支十神: undefined → 劫財
月柱地支十神: undefined → 偏官
日柱地支十神: undefined → 偏印
時柱地支十神: undefined → 比肩
地方時調整: 東京（経度139.77）=> 18分
特殊ケース処理を適用します: 2025-04-03T03:18:00.000Z 12 undefined
十神関係計算前の四柱情報:
日柱天干: 壬 日柱地支: 寅
年柱天干: 乙 年柱地支: 巳
月柱天干: 己 月柱地支: 卯
時柱天干: 癸 時柱地支: 午
十神関係計算結果: {
  "year": "傷官",
  "month": "正官",
  "day": "比肩",
  "hour": "劫財"
}
年柱地支: 巳
月柱地支: 卯
日柱地支: 寅
時柱地支: 午
日主天干: 壬
地支十神関係の計算結果:
年支(巳)の十神: 正財
月支(卯)の十神: 傷官
日支(寅)の十神: 食神
時支(午)の十神: 偏財
年支の蔵干: 丙(偏財), 庚(偏印), 戊(偏官)
最終的な地支の十神関係:
年柱地支十神: undefined → 正財
月柱地支十神: undefined → 傷官
日柱地支十神: undefined → 食神
時柱地支十神: undefined → 偏財
[FortuneController] 運勢生成成功: { fortuneId: 'fortune-67e487dbc4a58a62d38ac6ac-2025-04-03' }
[2025-04-03T02:57:59.233Z] レスポンス: 200 GET /api/v1/fortune/daily
レスポンスボディ: (省略)
[0mGET /api/v1/fortune/daily [32m200[0m 21.799 ms - 2634[0m
SIGTERMを受信しました。サーバーをシャットダウンします...
サーバーを正常にシャットダウンしました
2025-04-03 11:58:09:589 [33mwarn[39m: [33mMongoDB切断: 再接続を試みます[39m  
MongoDB接続を正常に終了しました
